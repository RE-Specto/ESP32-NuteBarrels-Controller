bugs:
fmsTask sonic 0 timeout after sonic >0 error while storing
    do sonics need time after mux switch?
do Fill Mix Store Drain  SENSOR CHECK pressure.measure will break logic at pressure error?
    need to close taps, wait in loop, and reopen using OpenTaps() once error cleared
    ! also remeasures constantly at Fill first measure if sensor error

to implement:
rename class methods to match
mixing should also check for flow
option to disable flow checks temporary by /settings webUI
    fill can work by sonic
    mix ok anyway
    store drain require flow sens?
        any sonic use for them?
fmsTask should allow escaping from fill to mix on manual state change
what happens if state = 0?
check all divides for cpu panic crash
check: State.SetStoreBarrel(State.FillBarrel()); for bugs
start should trigger unprotect?
separate manual fmsd from auto
untriger "protect" when pressure sensor back to normal?
    already sheduled below
    add an option to disable sensor checks from WebUI
sonic remeasure on high errorÂ±
    ignore the one that is out of range? or remeasure all?

void deleteStructs and webui command in manual

reenable //SaveStructs(); //disabled for mow.... when ready

test:
    fill huge ammount
    mix huge ammount
    fill 0
    fill 6
    store to itself
    store from 0 to 6
    store from 6 to 0
    drain 0
    drain 6

barr error set shoud save to sd? or save after each use in code?
    implement error unset from webui

serial print to telnet or to webui directly or via another board (esp8266?).

-solder dummy pressure sensor

!!! add a way to reset pressure error "protect" mode - by pressing start?
    use void pressure_sensor::ErrorReset(byte sens)

work on system hardware - implement all changes to schematic!!

check what modem returns if error - if valid check - implement SMS error

add calibration edit for all sensors to manual: 
use separate <forms> for each one?
    SystemState.state_set
    SystemState.state_unset
    SystemState.error_set
    SystemState.error_unset
    flow.MultSet(sens,mult)
    pressure.DividerSet
    pressure.OffsetSet
    pressure.MaxSet
    pressure.MinSet
    barrels.ErrorSet
    barrels.ErrorUnset
    barrels.ErrorReset
    barrels.SonicOffsetSet
    barrels.SonicMLinMMSet
    Settings.prefill_requirement
    Settings.afterfill_requirement deprecate??
    Settings.mix_requirement
    Settings.drain_requirement
    Settings.filling_barrel
    Settings.storing_barrel
    NTP Timezone + DTS
    manual mux unlock via webUI

what needed for barrel sonic calibration?
    dry barrel height - SonicOffsetSet
        measure at start
            SonicOffsetSet(barrX,SonicLastMM(barrX));
    how many mililiters is in one milimeter - SonicMLinMM
        fill with exact 100L
            Save100LitersMark
    full  barrel litrage - VolumeMaxSet
        fill untill sonic error
        drain safeguard value
            VolumeMaxSet(barrX, SonicCalcLiters(barrX))
    empty barrel litrage - VolumeMinSet
        drain barrel fully
            VolumeMinSet(barrX, SonicCalcLiters(barrX))
    


manual apply sonic value to flow barrel volume on request.

WebUI from "1-pump idea test (1).png" file with overlays and jQuery
    https://forum.jquery.com/topic/how-to-change-text-dynamically-svg
telnet server to send LOG.prints + telnet client inside webui?
allow to manually disable a barrel
    barrels.ErrorSet(barrel, BARREL_DISABLED)

uint16_t DTS = 0;                                              //mySettings.DTS?3600UL:0;
uint16_t timeZone = 3;    

limit all data from webUI to valid range - ie. no "measure barrel 27"

measure all sonic on system start so sonic have all values ready?

implement mux lock timeout.
    LockMUX should start an external timer and UnlockMUX should stop it

variables that survives reboot?? :)
try RTC_NOINIT_ATTR?
https://github.com/highno/rtcvars/issues/3

recheck concentration float is accurate
"Do not use float to represent whole numbers."
http://www.cplusplus.com/forum/general/67783/


add to schematic:
12v line add polyfuze
optional: doser on expander x20 pin A7? serial scale mux#14?










optional:
check all uint values never go below zero!!
    expected in sensor measurements
    anywhere else?

change sonic 10555  to retry--
    BARREL_SONIC_OUTOFRANGE only if all 10555
drain_log file
    needs accurate clock

make pressure sensor check constantly so i can turn off the pump on overpressure
    task loop inside other cpu core? or inside filling loop itself?
    ps2 only when pump working?
    ps1 only once before sol open + once if no flow + once at system start?

set Overpressure global error only if error occurs with multiple solenoids

add concentrationSet to barrels for manual?
use filter instead of avearge for sonic?
https://stackoverflow.com/questions/10338888/fast-median-filter-in-c-c-for-uint16-2d-array
restore to sd if spiffs date newer? fix timestamp
barrel busy flag?
add option to continue on pressure sensor1 error if flow1 ok
continue on ps2 error if flow2 is in range: 0 < flow2 < "flow2 with no load"
continue on flow error if sonic is rising
continue on sonic error if flow counted barrel volume is ok
continue to next barrel if barrel solenoids error
only unrecoverable errors: pump, main barrel solenoids

handle reset in the middle of flow sensor transfer
    calculate by last values?
    lock thread mux so it executes quick? https://esp32.com/viewtopic.php?t=1703

server.on("/mdns" check mdns broadcast
switchFS add fs check, try to restart filesystem on failure
add ... on serial.available to check module awake
"[E][vfs_api.cpp:22] open(): File system is not mounted" nice error reporting format 

pressure - in next version:
    if overpressure error - set target barrel error
    goto next barrel, clear overpressure error
    if all barrels error - set pump error - clear all barrel overpressure errors
      except manually-disabled barrels "error"
    if no pressure - loop-measure for a while
    if still no pressure - check flow
    no flow - set pump error.